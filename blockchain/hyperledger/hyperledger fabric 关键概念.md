# Hyperledger fabric 关键概念



# 介绍

Hyperledger Fabric 是一个分布式账本的区块链方案解决平台，采用模块化、提供高度机密、弹性灵活和可扩展的架构。它旨在支持不同组件模块的可插拔实现，并适应经济生态系统中复杂性。

## 什么是区块链？

区块链有三部分重要组成，它们分别是分布式分类账本、智能合约、共识机制。

### 分布式分类账本

区块链网络的核心是一个分布式的分类账本，记录区块链网络上发生的所有交易信息。

分布式分类账本是分散的，它们被复制到区块链网络中的不同节点上，每个参与者都维护其中的程序进行**协作**。所以分布式分类账本是分散和合作的强大，反映了企业在现实世界中交换商品和服务的方式。

![_images / basic_network.png](https://hyperledger-fabric.readthedocs.io/en/latest/_images/basic_network.png)

除了分散和协作的技术特点外，记录到区块链的信息数据还使用**加密**技术，保证数据一旦上链后将**无法修改**。这种**不可变**的特性让定位数据的**出处**变得简单。因为参与者可以确定数据信息在事后没有改变。这就是为什么区块链有时被描述为**证明系统的原因**。

### 智能合约

为了支持信息的一致更新特性，并启用分类账本的功能（交易、查询），区块链网络使用**智能合约**来提供对分类账本的受控访问。

![_images / Smart_Contract.png](https://hyperledger-fabric.readthedocs.io/en/latest/_images/Smart_Contract.png)

智能合约不仅是封装信息并在整个区块链网络中保持简单的关键机制。还可以编写参与者自动执行某些交易。例如：可以编写智能合约规定运输物品的成本，其中运费根据运输中的速度而变化，根据双方同意并写入分类账的条款。当收到物品时，适当的资金可以转手。

### 共识机制

共识是保持分类账本交易在整个区块链网络中同步的过程。确保分类账本仅仅在交易时被相应的参与者批准并执行更新，在当分类账本更新时，它们要以相同的顺序执行相同的交易数据更新，这系列动作被称为**共识**。

![_images / consensus.png](https://hyperledger-fabric.readthedocs.io/en/latest/_images/consensus.png)

区块链视为共享的复制交易系统就足够了，该系统通过智能合约进行更新，并通过称为共识的协作流程保持一致。

## 为什么区块链有用？

### **今天的记录系统** 

今天的交易网络都是自商业记录以来一直存在微小更新记录的网络版本。业务网络的成员彼此进行交易，他们各自维护自己的交易记录。

![_images / current_network.png](https://hyperledger-fabric.readthedocs.io/en/latest/_images/current_network.png)

现代技术已经从石碑布匹、纸质记录到硬盘或云存储演进，但所有系统底层结构都是相同的。由于所有参与者的身份不一致，要建立一个统一的系统是不可能。所有的合同是手动签署和执行，每个数据库都存储交易的唯一信息。即使可见性和信任的需求很明显，今天的信息和流程共享方法也不可能构建一个跨越业务网络的记录系统

### **区块链差异** 

由于现代的交易系统效率低下，而是在网络上建立身份、执行交易、存储数据。要想让数据一旦写入、无法修改，这时候就需要区块链网络。

![_images / future_net.png](https://hyperledger-fabric.readthedocs.io/en/latest/_images/future_net.png)

这是一个区块链网络，每个参与者都有一个分类账本的副本。除了共享分类账本 信息之外，还共享更新分类账本的过程。与现代系统不同，参与者的私人程序用于更新私人的分类账本，区块链系统具有共享分类账本和更新分类账本的特性。

通过共享分类账本协调业务网络能力，区块链网络可以减少与私人信息和处理的相关时间、成本和风险，同时提高信任和可见性。

### 什么是`Hyperledger Fabric`？

Linux基金会于2015年创建了`Hyperledger`项目，以推进跨行业的区块链技术。它不是宣布单一区块链标准，而是鼓励通过社区流程开发区块链技术的协作方法，其中包括鼓励开放式开发和随着时间的推移采用关键标准的知识产权。

`Hyperledger Fabric`是`Hyperledger`中的区块链项目之一。与其他区块链技术一样，它有一个分类账，使用智能合约，是参与者管理交易的系统。

`Hyperledger Fabric`从其他区块链系统中打破的地方是**私有**和**许可**。`Hyperledger Fabric`网络的成员通过可信赖的**会员服务提供商（MSP）**注册，而不是允许未知身份参与网络的开放式无权限系统（需要诸如“工作证明”之类的协议来验证交易并保护网络）。

`Hyperledger Fabric`还提供多种可插拔选项。分类帐数据可以以多种格式存储，共识机制可以交换进出，并且支持不同的`MSP`。

`Hyperledger Fabric`还提供创建**通道的功能**，允许一组参与者创建单独的交易分类帐。对于网络而言，这是一个特别重要的选择，其中一些参与者可能是竞争对手，并且不希望他们做出的每笔交易 - 例如，他们向某些参与者提供的特殊价格，而不是每个参与者都知道的其他参与者。如果两个参与者组成一个频道，那么这些参与者，而不是其他参与者拥有该频道的分类帐副本。

**共享分类帐** 

`Hyperledger Fabric`有一个分类账本子系统，它包括两个组件：**世界状态**和**交易日志**。每个参与者都拥有他们所属的`Hyperledger Fabric`网络中分类账本的一个副本。

世界状态描述了在给定时间点下的分类账本的状态，它是分类账本的数据库。交易日志组件记录当前分类账本的所有交易，它是世界状态的更新历史。然后，**分类账本是世界状态数据库和交易日志历史记录的组合**。

分类账本具有可以替换的状态数据库。默认情况下，是`LevelDB`键值存储数据库。交易日志不需要是可插入的，它只记录区块链网络中分类账本交易时数据库的前后值。

**智能合约**

`Hyperledger Fabric`智能合约以**链代码**编写，当该应用程序需要与分类帐交互时，由**区块**链外部的应用程序调用。在大多数情况下，`chaincode`只与分类帐的数据库组件，世界状态（例如，查询它）交互，而不与交易日志交互。

`Chaincode`可以用几种编程语言实现。目前，支持`Go`和`Node`、`Java`。

**隐私**

根据企业需求，在区块链网络中参与者对自己共享的信息可能非常的敏感。

`Hyperledger Fabric`支持隐私，可以使用通道方式来保护敏感数据。它是关键操作要求是相对开放的网络。

**共识**

交易必须按照发生的顺序写入分类账本，即使他们位于网络中不同的参与者之间。为此，必须建立交易的顺序，并且采用一种方法来拒绝错误（或恶意）的交易数据插入到分类账本中。

`Hyperledger Fabric`旨在允许网络启动者选择最能代表参与者之间存在的关系的共识机制。与隐私一样，有一系列需求；从在他们的关系中高度结构化的网络到更加点对点的网络。

我们将了解有关`Hyperledger Fabric`共识机制的更多信息，目前包括`SOLO`和`Kafka`。

# `Hyperledger Fabric` 功能

`Hyperledger Fabric` 是分布式账本技术（`DLT`）的一种实现，可在模块化架构区块链架构中提供企业级网络安全性，具有可扩展、机密性、高性能的特点。



## 身份管理

为了启用权限网络，`Hyperledger Fabric` 提供了一个**成员身份服务**功能，用于管理用户ID并对网络上的所有参与者进行**身份验证**。访问控制列表可用于通过授权特定网络操作来提供额外的权限控制层。例如，可以允许特定用户ID调用链代码应用程序，但是不能部署新的链代码。

## 隐私和保密

`Hyperledger Fabric` 使竞争的商业利益以及任何需要私密交易的群体能够在同一个权限网络上共存。专用的**通道**是受限的信息传递的路径，可以用于网络成员的特定子集提供**交易隐私和保密性**。通道上的所有数据（交易、成员、通道）都是**不可见**的，对于没有明确授权给通道的访问权限的任何网络成员都是不可访问的。

## 高效性能

`Hyperledger Fabric` 按节点类型分配**网络角色**，为了向网络提供**并发性和并行性**，**执行交易和交易排序、交易提交**是分开的。在排序交易之前执行交易能够使**每个对等节点同时处理多个交易**。这种并发执行提高了每个对等体的处理效率，并且**加速了向排序服务提供交易交付**速度。

除了并行处理之外，**分工**还可以减轻排序节点对交易执行和分类账本**维护的需求**，同时使对等节点**免于排序**（共识）服务的工作负载。角色的分配也**限制了授权和认证**的所需处理，所有对等节点都不必信任任何排序节点，反之亦然。因此一方上的进程可以独立于另一方的验证运行。

## `Chaincode`功能

`Chaincode` 应用程序编码由通道上特定类型的交易调用的逻辑。例如：变更资产所有权变更参数的 `Chaincode` 可确保所有转让所有权的交易都遵循相同的规则和要求。**系统链码**被区分为链码，其定义整个通道的操作参数；生命周期和配置系统链码定义了通道规则；认可和验证系统 `Chaincode` 定义了认可和验证交易的要求。

## 模块化设计

`Hyperledger Fabric` 实现了模块化架构，为网络设计人员提供了功能选择。例如：用于身份、排序（一致性）、加密的特定算法可以插入任何`Hyperledger Fabric`网络。结果是任何行业或公共领域都可以采用的通用区块链架构，并确保其网络可跨市场，监管和地理边界进行互操作。

# `Hyperledger Fabric` 模型

`Hyperledger Fabric` 的关键设计特性，实现了全面可定制的企业区块链解决方案的承诺：

+ **资产**：可以通过网络交换几乎任何具有货币价值的东西，从整个食品到古董、期货。
+ `Chaincode` ：Chaincode的执行和交易排序共识分开，限制了跨节点类型所需的信任和验证级别，并优化了网络可扩展性和性能。
+ **分类账功能**：不可变的共享分类账本为每个通道编码整个交易历史记录，并包括类似的`SQL`查询功能，以便进行有效的审计和解决争议。
+ **隐私**：通道和私人数据的收集实习了私密和加密的多边交易，这些交易通常是共同网上交换的资产的竞争企业和受监管行业所需求的。
+ **安全和会员服务**：允许会员资格提供可信任的区块链网络，参与者知道所有的交易都可以由授权的监管机构和审计员检测和跟踪。
+ **共识**：达成共识的可实现企业所需的灵活性和可扩展性。

## 资产

资产可以从有形（房地产和硬件）到无形资产（合同和知识产权）。`Hyperledger Fabric`提供链码交易修改资产的功能。

资产在`Hyperledger Fabric`中表示为**键值对的集合**，更改状态记录为通道分类账本上的交易。**资产可以用二进制或`JSON`格式表示**。

## `Chaincode`

`Chaincode` 是定义资产或资产的软件，以及修改资产的交易指令。可以将`Chaincode` 理解为业务逻辑。`Chaincode` 强制读取或更改键值对或其他状态数据库信息规则。`Chaincode` 函数针对当前分类账本的状态数据库执行，并通过交易提议启动执行。`Chaincode` 执行导致一组键值写入，可以提交给网络并应用于所有对等方的分类账。

## 分类账功能

分类账本是结构中**所有状态转换的顺序防篡改记录**。状态转换是参与方进行**提交链码调用（交易）**的结果。每个交易都会**生成一组资产键值对**，这些键值对作为创建、更新或删除提交到分类账本中。

分类账本由区块链上的**链**组成，用于**以块的形式存储不可变的顺序记录**。以及用于**维护当前结构状态的状态数据库**。**每个通道都有一个分类账本**，每个对等节点为所属的每个通道维护一个**分类账本的副本**。

**分类账本具有以下功能：**

+ 使用基于**秘钥的查找**，利用**范围查询**和**组合秘钥查询**来查询和更新分类账本
+ 使用丰富的查询语言作为**只读查询**（如果使用`CouchDB`作为状态数据库）
+ 只读历史记录查询，查询秘钥的分类账本历史记录，启用数据源方案
+ **交易包含**每个认可对等节点的**签名**，并**提交给排序**服务
+ 交易按顺序**进行排列**，并从排序服务**交付**到通道上的**对等同行**节点
+ 同行节点根据**认可策略验证交易并执行**认可策略
+ 在创建区块之前，执行**版本控制检查**，以明确确保自链码执行时间以来读取的**资产状态未发生更改**
+ 一旦交易**被验证并提交**，就存在**不变性**
+ 通道的分类账包含定义**策略、控制访问列表**和其他相关信息的**配置块**
+ 通道包含**成员资格服务提供程序**实例，允许从不同的证书颁发机构派生加密材料

## 隐私

`Hyperledger Fabric`在每个**通道**的基础上使用不可变**分类账本**，以及可以操纵和修改**资产**的当前状态（即更新键值对）的**链代码**。分类账本存在于**通道**范围内，它可以在**整个网络中**共享（假设每个参与者在一个公共通道上运营），或者它可以**私有化**以仅包括一组特定的参与者。

在后一种情况下，这些参与者将创建一个**单独的通道**，从而**隔离他们的分类账本和交易**。为了解决公开透明性和私密性之前差距的应用场景，可以**仅在需要访问资产状态和执行读取、写入的对等体节点上安装链码**（换句话说，如果未在对等体上安装链码，它将无法与分类账本正确的连接）。

当该通道上的组织子集需要**保密其交易**数据时，**私有数据集合**用于将此数据**隔离**在私有数据库中。**在逻辑上与通道分类账本分开，只能由授权的分类账本访问**。

因此，通道保持交易从**更广泛的网络中**保密，而集合使数据在**通道上的组织子集之间**保持私密。

为了进一步**混淆数据**，将在**交易发送到排序服务并将区块添加到分类账本**之前，可以使用诸如AES之类的**公共加密算法对链码内的值进行加密**（部分或全部）。一旦加密数据被写入分类帐本，它就只能由**拥有**用于生成密文的相应**密钥的用户解密**。

## 安全和会员服务

`Hyperledger Fabric`支持**交易网络**，所有参与者都**拥有已知的合法身份**。公钥基础结构用于**生成与组织绑定的加密证书**、网络组件和最终用户或客户端应用程序。因此，可以在更**广泛的网络和通道**级别上**操纵和管理数据访问控制**。`Hyperledger Fabric`的这种“许可”概念，加上通道的存在和功能，有助于解决**隐私和机密性**是最重要的问题。

## 共识

在分布式分类帐技术中，最近共识已成为单个函数内特定算法的同义词。然而，共识不仅包括简单地就**交易顺序达成一致**，而且`Hyperledger Fabric`通过其在整个**交易流程中的基本角色**，从**提案和认可、到订购、验证和提交**，突出了这种区别。简而言之，共识被定义为**构成块的一组交易的正确性的完整的循环验证**。

当块的**交易的订单和结果**满足明确的**策略标准检查**时，最终会**达成共识**。这些**检查和平衡**发生在交易的生命周期中，并包括使用**认可策略**来指定**哪些特定成员必须认可某个交易类**，以及**系统链代码以确保强制执行和维护这些策略**。在提交之前，**同行对等节点**将使用这些**系统链代码来确保存在足够的认可**，并且它们来自适当的实体。此外，在**包含交易**的任何块添加到分类帐之前，将进行**版本控制检查**，在此期间，分类账本的当前状态被同意。最终检查可**防止双重花费**操作和可能危及**数据完整性**的其他威胁，并允许针对非静态变量执行功能。

除了发生的大量背书认可，**有效性和版本控制检查**之外，还在**交易流的所有方向上发生持续的身份验证**。访问控制列表在网络的层次结构层上实现（将服务排序到通道），和有效负载重复签名验证和身份验证，交易提案通过不同的架构组件。总而言之，共识不仅限于一批交易的特定订单；相反，它是一种总体特征，是在交易从提案到提交的过程中进行的持续验证的副产品。

# 身份

## 什么是身份

区块链网络中的不同参与者包括`Peer`、`Orderer`、客户端应用程序，管理员等。这些参与者中的每一个（网络内部或外部能够**使用服务**的活动元素） 都具有封装在`X.509`数字证书中的数字身份。这些身份确实很重要，因为它们**确定了对资源的具体权限以及对参与者在区块链网络中拥有的信息的访问权限**。

此外，数字身份还具有`Fabric`用于确定权限的一些其他属性，并且它为身份和关联属性的并集提供了特殊名称 - **主体 Principal**。`Principal` 就像`userIDs`或`groupIDs`，但更灵活一点，因为它们可以包含`actor`的身份的各种属性，例如`actor`的组织，组织单位，角色甚至是`actor`的特定身份。当我们谈论主体时，它们是决定其权限的属性。

要使身份可以**验证**，它必须来自**可信任的**权威机构。[成员的服务提供商](https://hyperledger-fabric.readthedocs.io/en/latest/membership/membership.html) （`MSP`）是如何实现的`Fabric`。更具体地说，`MSP`是定义管理该组织的**有效身份规则**的组件。`Fabric`中的默认`MSP`实现使用`X.509`证书作为身份，采用传统的公钥基础结构（`PKI`）分层模型（稍后将详细介绍`PKI`）。

## 身份的使用场景

想象一下，你去超市购买一些杂货。在结账时，会看到一个标志，表示只接受`Visa`，`Mastercard`和`AMEX`卡。如果您尝试使用其他卡付款， 无论该卡是否真实且您的帐户中有足够的资金都无关紧要。它不会被接受！

![identity](https://hyperledger-fabric.readthedocs.io/en/latest/_images/identity.diagram.6.png)

**拥有有效的信用卡是不够的，它也必须被商店接受！`PKI`和`MSP`以相同的方式协同工作。`PKI`提供身份列表，`MSP`说哪些是参与网络的给定组织的成员**。

`PKI`证书颁发机构和`MSP`提供了类似的功能组合。`PKI`就像一个卡提供商，它分配了许多不同类型的可验证身份。另一方面，`MSP`类似于商店接受的卡提供商列表，确定哪些身份是商店支付网络的可信成员（参与者）。**`MSP`将可验证的身份转变为区块链网络的成员**。

## 什么是`PKI`

**公钥基础结构（`PKI`）是一组互联网技术，可在网络中提供安全通信**。它是将**`PK`放入`HTTPS`的`PKI`**，如果您在网络浏览器上阅读本文档，您可能正在使用`PKI`来确保它来自经过验证的来源。

![PKI](https://hyperledger-fabric.readthedocs.io/en/latest/_images/identity.diagram.7.png)

公钥基础结构（`PKI`）的元素。`PKI`由向各方（例如，服务的用户，服务提供商）**发布数字证书的证书颁发机构**组成，然后使用它们在与其环境交换的消息中对自己进行认证。**`CA`的证书吊销列表（`CRL`）构成不再有效的证书**的参考。证书的撤销可能由于多种原因而发生。例如，证书可能被撤销，因为与证书相关联的加密私有材料已被公开。

虽然区块链网络不仅仅是一个通信网络，但它**依赖于`PKI`标准来确保各个网络参与者之间的安全通信**，并**确保在区块链上发布的消息得到正确的认证**。因此，了解`PKI`的基础知识以及为什么`MSP`如此重要是非常重要的。

`PKI`有四个关键要素：

- **数字证书**
- **公钥和私钥**
- **证书颁发机构**
- **证书撤销列表**

## 数字证书

**数字证书是包含与证书持有者有关的一组属性的文档**。最常见的证书类型是以[X.509标准](https://en.wikipedia.org/wiki/X.509)的证书，它允许在其结构中编码一方的识别细节。

描述一个名为`Mary Morris`的当事人的**数字证书**。`Mary`是`SUBJECT`证书的副本，突出显示的`SUBJECT`文本显示了关于`Mary`的重要。如您所见，证书还包含更多信息。最重要的是，`Mary`的公钥是在她的证书中分发的，而她的私人签名密钥则不是，**此签名密钥必须保密**。

重要的是，玛丽的**所有属性**都可以**使用称为密码学的数学技术**进行记录，这样**篡改将使证书无效**。只要对方信任证书颁发者，称为**证书颁发机构**（CA），**密码学就允许`Mary`将证书提交给其他人以证明身份**。只要`CA`安全地保存某些加密信息（意味着它自己的**私人签名密钥**），任何阅读证书的人都可以确定有关`Mary`的信息没有被篡改，它将始终具有`Mary Morris`的特定属性。将`Mary`的`X.509`证书视为无法改变的数字身份证。

## 身份验证、公钥和私钥

**身份验证和消息完整性是安全通信中的重要概念**。身份验证要求确保交换消息的各方**创建特定消息的身份**。对于具有**完整性**的消息意味着**在其传输期间不能被修改**。例如，可能希望确保与真正的玛丽莫里斯而不是模仿者进行沟通。或者，如果Mary向您发送了一条消息，您可能希望确保其在传输过程中没有被其他任何人篡改过。

传统的身份验证机制依赖于**数字签名**，顾名思义，它允许一方对其消息进行数字**签名**。**数字签名还可以保证签名消息的完整性**。

从技术上讲，**数字签名机制要求每一方保存两个加密连接的密钥**：**广泛可用的公钥和充当认证的私钥**，以及用于在消息上产生**数字签名**的私钥 。数字签名消息的接收者可以通过检查**附加签名**在预期发送者的**公钥**下是否有效来验证接收消息的**来源和完整性**。

**私钥和相应公钥之间的唯一关系是使安全通信成为可能的加密魔法**。密钥之间的唯一数学关系使得**私钥**可以用于在仅**对应的公钥**可以匹配的消息上**产生签名**，并且**仅在相同的消息上**。

![AuthenticationKeys](https://hyperledger-fabric.readthedocs.io/en/latest/_images/identity.diagram.9.png)

在上面的示例中，`Mary`使用她的私钥对邮件进行签名。任何使用她的**公钥**查看签名消息的人都可以**验证签名**。

## 证书颁发机构

参与者或节点能够通过由**系统信任的机构**为其发布的**数字身份**参与区块链网络。在最常见的情况下，数字身份（或简称**身份**）具有符合`X.509`标准并由证书颁发机构（`CA`）颁发的经**加密验证**的数字证书的形式。

`CA`是互联网安全协议的常见部分，可能已经听说过一些比较流行的协议：`Symantec`（最初是`Verisign`），`GeoTrust`，`DigiCert`，`GoDaddy`和`Comodo`等。

![CertificateAuthorities](https://hyperledger-fabric.readthedocs.io/en/latest/_images/identity.diagram.11.png)

**证书颁发机构向不同的参与者分发证书**。这些证书由CA进行**数字签名**，并将**参与者与参与者的公钥**绑定在一起（并且可选地具有所有的属性列表）。因此，如果一个人**信任CA**（并且知道其公钥），则可以**信任**特定参与者**绑定到证书中包含的公钥**，并通过验证参与者证书上的CA签名来拥有所包含的属性。

证书可以广泛传播，因为它们既不包括**参与者**也不包括**CA的私钥**。因此，它们可以用作信任的锚节点，用于**验证来自不同参与者的消息**。

**CA也有一个证书，它们可以广泛使用**。这允许由给定CA**发布的身份**的消费者通过检查证书只能由**相应私钥（CA）的持有者**生成来验证它们。 

在区块链设置中，**每个希望与网络互动的参与者都需要一个身份**。在此设置中，您可能会说**一个或多个CA**可用于**从数字角度定义组织的成员**。CA是为组织的参与者提供**可验证的数字身份的基础**。

### 根`CA`，中间`CA`和信任链

CA的有两种形式：**根CA**和**中间CA**。由于`Root CA`（`Symantec`、`Geotrust`等）必须安全地向互联网用户**分发**数亿个证书，因此将此流程**分散到所谓的中间CA中**是有意义的。这些中间CA的**凭证**由**根CA或其他中间机构颁发**，允许为链中任何CA颁发的任何证书**建立“信任链”**。追溯到根CA的这种能力不仅允许CA的**功能扩展**，同时仍然提供安全性，允许使用证书的组织**充分信任**地使用中间CA，它限制了根CA的暴露，如果受到损害，将**危及整个信任链**。另一方面，如果中级CA受到损害，则曝光量会小得多。

![ChainOfTrust](https://hyperledger-fabric.readthedocs.io/en/latest/_images/identity.diagram.1.png)

只要每个中间CA的证书的颁发CA是**根CA本身**或具有对**根CA的信任链**，就在**根CA和一组中间CA之间建立信任链**。

中间CA在**跨多个组织**颁发证书时提供了巨大的**灵活性**，这在许可的区块链系统（如`Fabric`）中非常有用。例如，将看到**不同的组织可能使用不同的根CA**，或者使用具有**不同中间CA的相同根CA** ，它确实取决于网络的需求。

### `Fabric CA`

这是因为CA非常重要，`Fabric`提供了一个**内置的CA组件**，允许在**构成的区块链网络中创建CA**。此组件（称为`Fabric CA`）是一个**私有根CA提供程序**，能够管理具有`X.509`证书形式的`Fabric`参与者的**数字身份**。由于`Fabric CA`是针对`Fabric`的**根CA**需求的自定义CA，因此它本身无法为浏览器中的**创建/自动**使用提供`SSL`证书。但是，由于某些CA必须用于**管理身份**（即使在测试环境中），因此可以使用`Fabric CA`来提供和管理证书。使用**公共/商业根或中间CA**来提供识别也是可能的，并且完全合适。

## 证书撤销列表

证书撤销列表（`CRL`）很容易理解，它只是CA知道由于某种原因而被**撤销的证书的引用列表**。如果回想一下商店场景，`CRL`就像被盗信用卡列表一样。

**当第三方想要验证另一方的身份时，它首先检查颁发CA的`CRL`以确保证书尚未被撤销**。验证者不必检查`CRL`，但如果不是，则他们冒着接受**受损身份的风险**。

![CRL](https://hyperledger-fabric.readthedocs.io/en/latest/_images/identity.diagram.12.png)

使用CRL检查证书是否仍然有效。如果模仿者试图将受损的数字证书传递给验证方，则可以**首先检查颁发CA的CRL**，以确保其未列为不再有效。

请注意，**被撤销的证书与证书过期非常不同**。撤销的证书尚未过期，按其他措施，**它们是完全有效的证书**。有关CRL的更多深入信息，[请单击此处](https://hyperledger-fabric-ca.readthedocs.io/en/latest/users-guide.html#generating-a-crl-certificate-revocation-list)。

# 会员

如果已经阅读了有关身份的文档，那么已经了解了`PKI`如何通过信任链提供可验证的身份。现在让我们看看这些身份如何用于表示区块链网络的**可信成员**。

这就是**会员服务提供商**（`MSP`）发挥作用的地方，它**确定了哪些根CA和中间CA被信任来定义信任域**的成员，例如：一个组织，通过列出其成员的身份，或者通过识别哪些CA被授权为其成员发布有效身份，或者通常是这种情况通过两者的组合。

`MSP`的强大功能不仅仅是**列出谁是网络参与者或通道成员**。`MSP`可以识别参与者可能在`MSP`所代表的组织范围内发挥的**特定角色**（例如，管理员，或作为子组织组的成员），并**设置在网络和通道**（例如，频道管理员，读者，作家）的**上下文**中定义**访问权限**的基础。

`MSP`的配置被通告给相应组织的成员参与的**所有通道**（以通道`MSP`的形式）。除了通道`MSP`、对等节点、`Orderer`和客户端之外，还维护本地`MSP`以对**通道上下文之外的成员消息进行身份验证**，并定义对特定组件（具有在对等节点方上**安装链代码**的能力）的权限。

此外，`MSP`可以允许**识别已被撤销的身份列表**，如身份文档中所述。但我们将讨论该流程如何扩展到`MSP`。

## 将MSP映射到组织

**组织**是一组受管理的成员。这可以像跨国公司那样大，也可以像花店一样小。组织（`orgs`）最重要的是他们在一个`MSP`下管理他们的成员。请注意，这与`X.509`证书中定义的组织概念不同，我们将在稍后讨论。

组织与其`MSP`之间的独占关系使得在组织之后命名`MSP`是明智的，这是大多数策略配置中都会采用的约定。例如，组织`ORG1`可能会有一个名为`ORG1-MSP`的`MSP`。

## 本地MSP和通道MSP



## MSP级别



## MSP结构



