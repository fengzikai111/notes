# Hyperledger fabric 关键概念



# 介绍

Hyperledger Fabric 是一个分布式账本的区块链方案解决平台，采用模块化、提供高度机密、弹性灵活和可扩展的架构。它旨在支持不同组件模块的可插拔实现，并适应经济生态系统中复杂性。

## 什么是区块链？

区块链有三部分重要组成，它们分别是分布式分类账本、智能合约、共识机制。

### 分布式分类账本

区块链网络的核心是一个分布式的分类账本，记录区块链网络上发生的所有交易信息。

分布式分类账本是分散的，它们被复制到区块链网络中的不同节点上，每个参与者都维护其中的程序进行**协作**。所以分布式分类账本是分散和合作的强大，反映了企业在现实世界中交换商品和服务的方式。

![_images / basic_network.png](https://hyperledger-fabric.readthedocs.io/en/latest/_images/basic_network.png)

除了分散和协作的技术特点外，记录到区块链的信息数据还使用**加密**技术，保证数据一旦上链后将**无法修改**。这种**不可变**的特性让定位数据的**出处**变得简单。因为参与者可以确定数据信息在事后没有改变。这就是为什么区块链有时被描述为**证明系统的原因**。

### 智能合约

为了支持信息的一致更新特性，并启用分类账本的功能（交易、查询），区块链网络使用**智能合约**来提供对分类账本的受控访问。

![_images / Smart_Contract.png](https://hyperledger-fabric.readthedocs.io/en/latest/_images/Smart_Contract.png)

智能合约不仅是封装信息并在整个区块链网络中保持简单的关键机制。还可以编写参与者自动执行某些交易。例如：可以编写智能合约规定运输物品的成本，其中运费根据运输中的速度而变化，根据双方同意并写入分类账的条款。当收到物品时，适当的资金可以转手。

### 共识机制

共识是保持分类账本交易在整个区块链网络中同步的过程。确保分类账本仅仅在交易时被相应的参与者批准并执行更新，在当分类账本更新时，它们要以相同的顺序执行相同的交易数据更新，这系列动作被称为**共识**。

![_images / consensus.png](https://hyperledger-fabric.readthedocs.io/en/latest/_images/consensus.png)

区块链视为共享的复制交易系统就足够了，该系统通过智能合约进行更新，并通过称为共识的协作流程保持一致。

## 为什么区块链有用？

### **今天的记录系统** 

今天的交易网络都是自商业记录以来一直存在微小更新记录的网络版本。业务网络的成员彼此进行交易，他们各自维护自己的交易记录。

![_images / current_network.png](https://hyperledger-fabric.readthedocs.io/en/latest/_images/current_network.png)

现代技术已经从石碑布匹、纸质记录到硬盘或云存储演进，但所有系统底层结构都是相同的。由于所有参与者的身份不一致，要建立一个统一的系统是不可能。所有的合同是手动签署和执行，每个数据库都存储交易的唯一信息。即使可见性和信任的需求很明显，今天的信息和流程共享方法也不可能构建一个跨越业务网络的记录系统

### **区块链差异** 

由于现代的交易系统效率低下，而是在网络上建立身份、执行交易、存储数据。要想让数据一旦写入、无法修改，这时候就需要区块链网络。

![_images / future_net.png](https://hyperledger-fabric.readthedocs.io/en/latest/_images/future_net.png)

这是一个区块链网络，每个参与者都有一个分类账本的副本。除了共享分类账本 信息之外，还共享更新分类账本的过程。与现代系统不同，参与者的私人程序用于更新私人的分类账本，区块链系统具有共享分类账本和更新分类账本的特性。

通过共享分类账本协调业务网络能力，区块链网络可以减少与私人信息和处理的相关时间、成本和风险，同时提高信任和可见性。

### 什么是`Hyperledger Fabric`？

Linux基金会于2015年创建了`Hyperledger`项目，以推进跨行业的区块链技术。它不是宣布单一区块链标准，而是鼓励通过社区流程开发区块链技术的协作方法，其中包括鼓励开放式开发和随着时间的推移采用关键标准的知识产权。

`Hyperledger Fabric`是`Hyperledger`中的区块链项目之一。与其他区块链技术一样，它有一个分类账，使用智能合约，是参与者管理交易的系统。

`Hyperledger Fabric`从其他区块链系统中打破的地方是**私有**和**许可**。`Hyperledger Fabric`网络的成员通过可信赖的**会员服务提供商（MSP）**注册，而不是允许未知身份参与网络的开放式无权限系统（需要诸如“工作证明”之类的协议来验证交易并保护网络）。

`Hyperledger Fabric`还提供多种可插拔选项。分类帐数据可以以多种格式存储，共识机制可以交换进出，并且支持不同的`MSP`。

`Hyperledger Fabric`还提供创建**通道的功能**，允许一组参与者创建单独的交易分类帐。对于网络而言，这是一个特别重要的选择，其中一些参与者可能是竞争对手，并且不希望他们做出的每笔交易 - 例如，他们向某些参与者提供的特殊价格，而不是每个参与者都知道的其他参与者。如果两个参与者组成一个通道，那么这些参与者，而不是其他参与者拥有该通道的分类帐副本。

**共享分类帐** 

`Hyperledger Fabric`有一个分类账本子系统，它包括两个组件：**世界状态**和**交易日志**。每个参与者都拥有他们所属的`Hyperledger Fabric`网络中分类账本的一个副本。

世界状态描述了在给定时间点下的分类账本的状态，它是分类账本的数据库。交易日志组件记录当前分类账本的所有交易，它是世界状态的更新历史。然后，**分类账本是世界状态数据库和交易日志历史记录的组合**。

分类账本具有可以替换的状态数据库。默认情况下，是`LevelDB`键值存储数据库。交易日志不需要是可插入的，它只记录区块链网络中分类账本交易时数据库的前后值。

**智能合约**

`Hyperledger Fabric`智能合约以**链代码**编写，当该应用程序需要与分类帐交互时，由**区块**链外部的应用程序调用。在大多数情况下，`chaincode`只与分类帐的数据库组件，世界状态（例如，查询它）交互，而不与交易日志交互。

`Chaincode`可以用几种编程语言实现。目前，支持`Go`和`Node`、`Java`。

**隐私**

根据企业需求，在区块链网络中参与者对自己共享的信息可能非常的敏感。

`Hyperledger Fabric`支持隐私，可以使用通道方式来保护敏感数据。它是关键操作要求是相对开放的网络。

**共识**

交易必须按照发生的顺序写入分类账本，即使他们位于网络中不同的参与者之间。为此，必须建立交易的顺序，并且采用一种方法来拒绝错误（或恶意）的交易数据插入到分类账本中。

`Hyperledger Fabric`旨在允许网络启动者选择最能代表参与者之间存在的关系的共识机制。与隐私一样，有一系列需求；从在他们的关系中高度结构化的网络到更加点对点的网络。

我们将了解有关`Hyperledger Fabric`共识机制的更多信息，目前包括`SOLO`和`Kafka`。

# `Hyperledger Fabric` 功能

`Hyperledger Fabric` 是分布式账本技术（`DLT`）的一种实现，可在模块化架构区块链架构中提供企业级网络安全性，具有可扩展、机密性、高性能的特点。



## 身份管理

为了启用权限网络，`Hyperledger Fabric` 提供了一个**成员身份服务**功能，用于管理用户ID并对网络上的所有参与者进行**身份验证**。访问控制列表可用于通过授权特定网络操作来提供额外的权限控制层。例如，可以允许特定用户ID调用链代码应用程序，但是不能部署新的链代码。

## 隐私和保密

`Hyperledger Fabric` 使竞争的商业利益以及任何需要私密交易的群体能够在同一个权限网络上共存。专用的**通道**是受限的信息传递的路径，可以用于网络成员的特定子集提供**交易隐私和保密性**。通道上的所有数据（交易、成员、通道）都是**不可见**的，对于没有明确授权给通道的访问权限的任何网络成员都是不可访问的。

## 高效性能

`Hyperledger Fabric` 按节点类型分配**网络角色**，为了向网络提供**并发性和并行性**，**执行交易和交易排序、交易提交**是分开的。在排序交易之前执行交易能够使**每个对等节点同时处理多个交易**。这种并发执行提高了每个对等体的处理效率，并且**加速了向排序服务提供交易交付**速度。

除了并行处理之外，**分工**还可以减轻排序节点对交易执行和分类账本**维护的需求**，同时使对等节点**免于排序**（共识）服务的工作负载。角色的分配也**限制了授权和认证**的所需处理，所有对等节点都不必信任任何排序节点，反之亦然。因此一方上的进程可以独立于另一方的验证运行。

## `Chaincode`功能

`Chaincode` 应用程序编码由通道上特定类型的交易调用的逻辑。例如：变更资产所有权变更参数的 `Chaincode` 可确保所有转让所有权的交易都遵循相同的规则和要求。**系统链码**被区分为链码，其定义整个通道的操作参数；生命周期和配置系统链码定义了通道规则；认可和验证系统 `Chaincode` 定义了认可和验证交易的要求。

## 模块化设计

`Hyperledger Fabric` 实现了模块化架构，为网络设计人员提供了功能选择。例如：用于身份、排序（一致性）、加密的特定算法可以插入任何`Hyperledger Fabric`网络。结果是任何行业或公共领域都可以采用的通用区块链架构，并确保其网络可跨市场，监管和地理边界进行互操作。

# `Hyperledger Fabric` 模型

`Hyperledger Fabric` 的关键设计特性，实现了全面可定制的企业区块链解决方案的承诺：

+ **资产**：可以通过网络交换几乎任何具有货币价值的东西，从整个食品到古董、期货。
+ `Chaincode` ：Chaincode的执行和交易排序共识分开，限制了跨节点类型所需的信任和验证级别，并优化了网络可扩展性和性能。
+ **分类账功能**：不可变的共享分类账本为每个通道编码整个交易历史记录，并包括类似的`SQL`查询功能，以便进行有效的审计和解决争议。
+ **隐私**：通道和私人数据的收集实习了私密和加密的多边交易，这些交易通常是共同网上交换的资产的竞争企业和受监管行业所需求的。
+ **安全和会员服务**：允许会员资格提供可信任的区块链网络，参与者知道所有的交易都可以由授权的监管机构和审计员检测和跟踪。
+ **共识**：达成共识的可实现企业所需的灵活性和可扩展性。

## 资产

资产可以从有形（房地产和硬件）到无形资产（合同和知识产权）。`Hyperledger Fabric`提供链码交易修改资产的功能。

资产在`Hyperledger Fabric`中表示为**键值对的集合**，更改状态记录为通道分类账本上的交易。**资产可以用二进制或`JSON`格式表示**。

## `Chaincode`

`Chaincode` 是定义资产或资产的软件，以及修改资产的交易指令。可以将`Chaincode` 理解为业务逻辑。`Chaincode` 强制读取或更改键值对或其他状态数据库信息规则。`Chaincode` 函数针对当前分类账本的状态数据库执行，并通过交易提议启动执行。`Chaincode` 执行导致一组键值写入，可以提交给网络并应用于所有对等方的分类账。

## 分类账功能

分类账本是结构中**所有状态转换的顺序防篡改记录**。状态转换是参与方进行**提交链码调用（交易）**的结果。每个交易都会**生成一组资产键值对**，这些键值对作为创建、更新或删除提交到分类账本中。

分类账本由区块链上的**链**组成，用于**以块的形式存储不可变的顺序记录**。以及用于**维护当前结构状态的状态数据库**。**每个通道都有一个分类账本**，每个对等节点为所属的每个通道维护一个**分类账本的副本**。

**分类账本具有以下功能：**

+ 使用基于**秘钥的查找**，利用**范围查询**和**组合秘钥查询**来查询和更新分类账本
+ 使用丰富的查询语言作为**只读查询**（如果使用`CouchDB`作为状态数据库）
+ 只读历史记录查询，查询秘钥的分类账本历史记录，启用数据源方案
+ **交易包含**每个认可对等节点的**签名**，并**提交给排序**服务
+ 交易按顺序**进行排列**，并从排序服务**交付**到通道上的**对等对等**节点
+ 对等节点根据**认可策略验证交易并执行**认可策略
+ 在创建区块之前，执行**版本控制检查**，以明确确保自链码执行时间以来读取的**资产状态未发生更改**
+ 一旦交易**被验证并提交**，就存在**不变性**
+ 通道的分类账包含定义**策略、控制访问列表**和其他相关信息的**配置块**
+ 通道包含**成员资格服务提供程序**实例，允许从不同的证书颁发机构派生加密材料

## 隐私

`Hyperledger Fabric`在每个**通道**的基础上使用不可变**分类账本**，以及可以操纵和修改**资产**的当前状态（即更新键值对）的**链代码**。分类账本存在于**通道**范围内，它可以在**整个网络中**共享（假设每个参与者在一个公共通道上运营），或者它可以**私有化**以仅包括一组特定的参与者。

在后一种情况下，这些参与者将创建一个**单独的通道**，从而**隔离他们的分类账本和交易**。为了解决公开透明性和私密性之前差距的应用场景，可以**仅在需要访问资产状态和执行读取、写入的对等体节点上安装链码**（换句话说，如果未在对等体上安装链码，它将无法与分类账本正确的连接）。

当该通道上的组织子集需要**保密其交易**数据时，**私有数据集合**用于将此数据**隔离**在私有数据库中。**在逻辑上与通道分类账本分开，只能由授权的分类账本访问**。

因此，通道保持交易从**更广泛的网络中**保密，而集合使数据在**通道上的组织子集之间**保持私密。

为了进一步**混淆数据**，将在**交易发送到排序服务并将区块添加到分类账本**之前，可以使用诸如AES之类的**公共加密算法对链码内的值进行加密**（部分或全部）。一旦加密数据被写入分类帐本，它就只能由**拥有**用于生成密文的相应**密钥的用户解密**。

## 安全和会员服务

`Hyperledger Fabric`支持**交易网络**，所有参与者都**拥有已知的合法身份**。公钥基础结构用于**生成与组织绑定的加密证书**、网络组件和最终用户或客户端应用程序。因此，可以在更**广泛的网络和通道**级别上**操纵和管理数据访问控制**。`Hyperledger Fabric`的这种“许可”概念，加上通道的存在和功能，有助于解决**隐私和机密性**是最重要的问题。

## 共识

在分布式分类帐技术中，最近共识已成为单个函数内特定算法的同义词。然而，共识不仅包括简单地就**交易顺序达成一致**，而且`Hyperledger Fabric`通过其在整个**交易流程中的基本角色**，从**提案和认可、到订购、验证和提交**，突出了这种区别。简而言之，共识被定义为**构成块的一组交易的正确性的完整的循环验证**。

当块的**交易的订单和结果**满足明确的**策略标准检查**时，最终会**达成共识**。这些**检查和平衡**发生在交易的生命周期中，并包括使用**认可策略**来指定**哪些特定成员必须认可某个交易类**，以及**系统链代码以确保强制执行和维护这些策略**。在提交之前，**对等对等节点**将使用这些**系统链代码来确保存在足够的认可**，并且它们来自适当的实体。此外，在**包含交易**的任何块添加到分类帐之前，将进行**版本控制检查**，在此期间，分类账本的当前状态被同意。最终检查可**防止双重花费**操作和可能危及**数据完整性**的其他威胁，并允许针对非静态变量执行功能。

除了发生的大量背书认可，**有效性和版本控制检查**之外，还在**交易流的所有方向上发生持续的身份验证**。访问控制列表在网络的层次结构层上实现（将服务排序到通道），和有效负载重复签名验证和身份验证，交易提案通过不同的架构组件。总而言之，共识不仅限于一批交易的特定订单；相反，它是一种总体特征，是在交易从提案到提交的过程中进行的持续验证的副产品。

# `Identity` 身份

## 什么是身份

区块链网络中的不同参与者包括`Peer`、`Orderer`、客户端应用程序，管理员等。这些参与者中的每一个（网络内部或外部能够**使用服务**的活动元素） 都具有封装在`X.509`数字证书中的数字身份。这些身份确实很重要，因为它们**确定了对资源的具体权限以及对参与者在区块链网络中拥有的信息的访问权限**。

此外，数字身份还具有`Fabric`用于确定权限的一些其他属性，并且它为身份和关联属性的并集提供了特殊名称 - **主体 Principal**。`Principal` 就像`userIDs`或`groupIDs`，但更灵活一点，因为它们可以包含参与者的身份的各种属性，例如参与者的组织，组织单位，角色甚至是参与者的特定身份。当我们谈论主体时，它们是决定其权限的属性。

要使身份可以**验证**，它必须来自**可信任的**权威机构。[成员的服务提供商](https://hyperledger-fabric.readthedocs.io/en/latest/membership/membership.html) （`MSP`）是如何实现的`Fabric`。更具体地说，`MSP`是定义管理该组织的**有效身份规则**的组件。`Fabric`中的默认`MSP`实现使用`X.509`证书作为身份，采用传统的公钥基础结构（`PKI`）分层模型（稍后将详细介绍`PKI`）。

## 身份的使用场景

想象一下，你去超市购买一些杂货。在结账时，会看到一个标志，表示只接受`Visa`，`Mastercard`和`AMEX`卡。如果您尝试使用其他卡付款， 无论该卡是否真实且您的帐户中有足够的资金都无关紧要。它不会被接受！

![identity](https://hyperledger-fabric.readthedocs.io/en/latest/_images/identity.diagram.6.png)

**拥有有效的信用卡是不够的，它也必须被商店接受！`PKI`和`MSP`以相同的方式协同工作。`PKI`提供身份列表，`MSP`说哪些是参与网络的给定组织的成员**。

`PKI`证书颁发机构和`MSP`提供了类似的功能组合。`PKI`就像一个卡提供商，它分配了许多不同类型的可验证身份。另一方面，`MSP`类似于商店接受的卡提供商列表，确定哪些身份是商店支付网络的可信成员（参与者）。**`MSP`将可验证的身份转变为区块链网络的成员**。

## 什么是`PKI`

**公钥基础结构（`PKI`）是一组互联网技术，可在网络中提供安全通信**。它是将**`PK`放入`HTTPS`的`PKI`**，如果您在网络浏览器上阅读本文档，您可能正在使用`PKI`来确保它来自经过验证的来源。

![PKI](https://hyperledger-fabric.readthedocs.io/en/latest/_images/identity.diagram.7.png)

公钥基础结构（`PKI`）的元素。`PKI`由向各方（例如，服务的用户，服务提供商）**发布数字证书的证书颁发机构**组成，然后使用它们在与其环境交换的消息中对自己进行认证。**`CA`的证书吊销列表（`CRL`）构成不再有效的证书**的参考。证书的撤销可能由于多种原因而发生。例如，证书可能被撤销，因为与证书相关联的加密私有材料已被公开。

虽然区块链网络不仅仅是一个通信网络，但它**依赖于`PKI`标准来确保各个网络参与者之间的安全通信**，并**确保在区块链上发布的消息得到正确的认证**。因此，了解`PKI`的基础知识以及为什么`MSP`如此重要是非常重要的。

`PKI`有四个关键要素：

- **数字证书**
- **公钥和私钥**
- **证书颁发机构**
- **证书撤销列表**

## 数字证书

**数字证书是包含与证书持有者有关的一组属性的文档**。最常见的证书类型是以[X.509标准](https://en.wikipedia.org/wiki/X.509)的证书，它允许在其结构中编码一方的识别细节。

描述一个名为`Mary Morris`的当事人的**数字证书**。`Mary`是`SUBJECT`证书的副本，突出显示的`SUBJECT`文本显示了关于`Mary`的重要。如您所见，证书还包含更多信息。最重要的是，`Mary`的公钥是在她的证书中分发的，而她的私人签名密钥则不是，**此签名密钥必须保密**。

重要的是，玛丽的**所有属性**都可以**使用称为密码学的数学技术**进行记录，这样**篡改将使证书无效**。只要对方信任证书颁发者，称为**证书颁发机构**（CA），**密码学就允许`Mary`将证书提交给其他人以证明身份**。只要`CA`安全地保存某些加密信息（意味着它自己的**私人签名密钥**），任何阅读证书的人都可以确定有关`Mary`的信息没有被篡改，它将始终具有`Mary Morris`的特定属性。将`Mary`的`X.509`证书视为无法改变的数字身份证。

## 身份验证、公钥和私钥

**身份验证和消息完整性是安全通信中的重要概念**。身份验证要求确保交换消息的各方**创建特定消息的身份**。对于具有**完整性**的消息意味着**在其传输期间不能被修改**。例如，可能希望确保与真正的玛丽莫里斯而不是模仿者进行沟通。或者，如果Mary向您发送了一条消息，您可能希望确保其在传输过程中没有被其他任何人篡改过。

传统的身份验证机制依赖于**数字签名**，顾名思义，它允许一方对其消息进行数字**签名**。**数字签名还可以保证签名消息的完整性**。

从技术上讲，**数字签名机制要求每一方保存两个加密连接的密钥**：**广泛可用的公钥和充当认证的私钥**，以及用于在消息上产生**数字签名**的私钥 。数字签名消息的接收者可以通过检查**附加签名**在预期发送者的**公钥**下是否有效来验证接收消息的**来源和完整性**。

**私钥和相应公钥之间的唯一关系是使安全通信成为可能的加密魔法**。密钥之间的唯一数学关系使得**私钥**可以用于在仅**对应的公钥**可以匹配的消息上**产生签名**，并且**仅在相同的消息上**。

![AuthenticationKeys](https://hyperledger-fabric.readthedocs.io/en/latest/_images/identity.diagram.9.png)

在上面的示例中，`Mary`使用她的私钥对邮件进行签名。任何使用她的**公钥**查看签名消息的人都可以**验证签名**。

## 证书颁发机构

参与者或节点能够通过由**系统信任的机构**为其发布的**数字身份**参与区块链网络。在最常见的情况下，数字身份（或简称**身份**）具有符合`X.509`标准并由证书颁发机构（`CA`）颁发的经**加密验证**的数字证书的形式。

`CA`是互联网安全协议的常见部分，可能已经听说过一些比较流行的协议：`Symantec`（最初是`Verisign`），`GeoTrust`，`DigiCert`，`GoDaddy`和`Comodo`等。

![CertificateAuthorities](https://hyperledger-fabric.readthedocs.io/en/latest/_images/identity.diagram.11.png)

**证书颁发机构向不同的参与者分发证书**。这些证书由CA进行**数字签名**，并将**参与者与参与者的公钥**绑定在一起（并且可选地具有所有的属性列表）。因此，如果一个人**信任CA**（并且知道其公钥），则可以**信任**特定参与者**绑定到证书中包含的公钥**，并通过验证参与者证书上的CA签名来拥有所包含的属性。

证书可以广泛传播，因为它们既不包括**参与者**也不包括**CA的私钥**。因此，它们可以用作信任的锚节点，用于**验证来自不同参与者的消息**。

**CA也有一个证书，它们可以广泛使用**。这允许由给定CA**发布的身份**的消费者通过检查证书只能由**相应私钥（CA）的持有者**生成来验证它们。 

在区块链设置中，**每个希望与网络互动的参与者都需要一个身份**。在此设置中，您可能会说**一个或多个CA**可用于**从数字角度定义组织的成员**。CA是为组织的参与者提供**可验证的数字身份的基础**。

### 根`CA`，中间`CA`和信任链

CA的有两种形式：**根CA**和**中间CA**。由于`Root CA`（`Symantec`、`Geotrust`等）必须安全地向互联网用户**分发**数亿个证书，因此将此流程**分散到所谓的中间CA中**是有意义的。这些中间CA的**凭证**由**根CA或其他中间机构颁发**，允许为链中任何CA颁发的任何证书**建立“信任链”**。追溯到根CA的这种能力不仅允许CA的**功能扩展**，同时仍然提供安全性，允许使用证书的组织**充分信任**地使用中间CA，它限制了根CA的暴露，如果受到损害，将**危及整个信任链**。另一方面，如果中级CA受到损害，则曝光量会小得多。

![ChainOfTrust](https://hyperledger-fabric.readthedocs.io/en/latest/_images/identity.diagram.1.png)

只要每个中间CA的证书的颁发CA是**根CA本身**或具有对**根CA的信任链**，就在**根CA和一组中间CA之间建立信任链**。

中间CA在**跨多个组织**颁发证书时提供了巨大的**灵活性**，这在许可的区块链系统（如`Fabric`）中非常有用。例如，将看到**不同的组织可能使用不同的根CA**，或者使用具有**不同中间CA的相同根CA** ，它确实取决于网络的需求。

### `Fabric CA`

这是因为CA非常重要，`Fabric`提供了一个**内置的CA组件**，允许在**构成的区块链网络中创建CA**。此组件（称为`Fabric CA`）是一个**私有根CA提供程序**，能够管理具有`X.509`证书形式的`Fabric`参与者的**数字身份**。由于`Fabric CA`是针对`Fabric`的**根CA**需求的自定义CA，因此它本身无法为浏览器中的**创建/自动**使用提供`SSL`证书。但是，由于某些CA必须用于**管理身份**（即使在测试环境中），因此可以使用`Fabric CA`来提供和管理证书。使用**公共/商业根或中间CA**来提供识别也是可能的，并且完全合适。

## 证书撤销列表

证书撤销列表（`CRL`）很容易理解，它只是CA知道由于某种原因而被**撤销的证书的引用列表**。如果回想一下商店场景，`CRL`就像被盗信用卡列表一样。

**当第三方想要验证另一方的身份时，它首先检查颁发CA的`CRL`以确保证书尚未被撤销**。验证者不必检查`CRL`，但如果不是，则他们冒着接受**受损身份的风险**。

![CRL](https://hyperledger-fabric.readthedocs.io/en/latest/_images/identity.diagram.12.png)

使用CRL检查证书是否仍然有效。如果模仿者试图将受损的数字证书传递给验证方，则可以**首先检查颁发CA的CRL**，以确保其未列为不再有效。

请注意，**被撤销的证书与证书过期非常不同**。撤销的证书尚未过期，按其他措施，**它们是完全有效的证书**。有关CRL的更多深入信息，[请单击此处](https://hyperledger-fabric-ca.readthedocs.io/en/latest/users-guide.html#generating-a-crl-certificate-revocation-list)。

# `Membership` 会员

如果已经阅读了有关身份的文档，那么已经了解了`PKI`如何通过信任链提供可验证的身份。现在让我们看看这些身份如何用于表示区块链网络的**可信成员**。

这就是**会员服务提供商**（`MSP`）发挥作用的地方，它**确定了哪些根CA和中间CA被信任来定义信任域**的成员，例如：一个组织，通过列出其成员的身份，或者通过识别哪些CA被授权为其成员发布有效身份，或者通常是这种情况通过两者的组合。

`MSP`的强大功能不仅仅是**列出谁是网络参与者或通道成员**。`MSP`可以识别参与者可能在`MSP`所代表的组织范围内发挥的**特定角色**（例如，管理员，或作为子组织组的成员），并**设置在网络和通道**（例如，通道管理员，读者，作家）的**上下文**中定义**访问权限**的基础。

`MSP`的配置被通告给相应组织的成员参与的**所有通道**（以通道`MSP`的形式）。除了通道`MSP`、对等节点、`Orderer`和客户端之外，还维护本地`MSP`以对**通道上下文之外的成员消息进行身份验证**，并定义对特定组件（具有在对等节点方上**安装链代码**的能力）的权限。

此外，`MSP`可以允许**识别已被撤销的身份列表**，如身份文档中所述。但我们将讨论该流程如何扩展到`MSP`。

## 将`MSP`映射到组织

**组织**是一组**受管理的成员**。这可以像跨国公司那样大，也可以像花店一样小。组织（`orgs`）最重要的是他们在一个`MSP`下**管理他们的成员**。请注意，这与`X.509`证书中定义的组织概念不同，我们将在稍后讨论。

组织与其`MSP`之间的独占关系使得在组织之后命名`MSP`是明智的，这是大多数策略配置中都会采用的约定。例如，组织`ORG1`可能会有一个名为`ORG1-MSP`的`MSP`。在某些情况下，组织可能需要多个成员资格组，例如，使用通道在组织之间执行非常不同的业务功能。在这种情况下是有意义的有多个`MSP`和因此他们的名字，例如，`ORG2-MSP-NATIONAL`和 `ORG2-MSP-GOVERNMENT`，反映了内部的信任的不同成员的根 `ORG2`在`NATIONAL`相对于销售通道`GOVERNMENT`的监管通道。

![MSP1](https://hyperledger-fabric.readthedocs.io/en/latest/_images/membership.diagram.3.png)

组织的两种不同`MSP`配置。第一个配置显示`MSP`与组织之间的典型关系，单个`MSP`定义组织成员列表。在第二种配置中，不同的`MSP`用于表示具有国家，国际和政府关联的不同组织组。

### 组织单位和`MSP`

组织通常被划分为多个**组织单位**（`OU`），每个**组织单位**都有一定的责任。例如，`ORG1` 组织可能有两个`ORG1-MANUFACTURING`和`ORG1-DISTRIBUTION` `OU`来反映这些独立的业务线。当`CA`颁发`X.509`证书时，证书中的`OU`字段指定标识所属的业务线。

稍后我们将看到`OU`如何有助于控制被视为区块链网络成员的组织部分。例如，只有来自`ORG1-MANUFACTURING` `OU`的身份可能能够访问通道，而`ORG1-DISTRIBUTION`不能。

最后，尽管这是对`OU`的轻微滥用，但它们有时可以被联盟中的不同组织用来区分彼此。在这种情况下，不同的组织将相同的根`CA`和中间`CA`用于其信任链，但是指定该`OU`字段以标识每个组织的成员。我们还将看到如何配置`MSP`以便以后实现此目的。

## 本地`MSP`和通道`MSP`

`MSP`出现在区块链网络中的两个位置：通道配置（**通道`MSP`**），以及在参与者的前提下**本地**（**本地`MSP`**）。**为客户端（用户）和节点（对等端和订购者）定义本地MSP**。本地节点`MSP`定义该节点的权限（例如，对等管理员是谁）。用户的本地`MSP`允许用户侧在其交易中作为通道的成员（例如，在链代码交易中）认证自身，或者作为特定角色的所有者在系统中进行认证（例如，在组织中的组织管理员）交易。

**每个节点和用户都必须定义一个本地MSP**，因为它定义了谁在该级别具有管理或参与权限（对等管理员不一定是通道管理员，反之亦然）。

相反，**通道MSP在通道层面定义了行政和参与权利**。参与通道的每个组织都必须为其定义`MSP`。通道上的对等体和订购者都将**共享相同的通道`MSP`视图**，因此能够正确地验证通道参与者。这意味着，如果组织希望加入该通道，则需要**将包含该组织成员信任链的`MSP`纳入通道配置**中。否则，将拒绝源自该组织身份的交易。

本地`MSP`和通道`MSP`之间的关键区别不在于它们如何运作，既将身份转变为角色，又是其**范围**。

![MSP2](https://hyperledger-fabric.readthedocs.io/en/latest/_images/membership.diagram.4.png)本地和渠道`MSP`。每个对等体的信任域（例如，组织）由对等体的本地`MSP`定义，例如`ORG1`或`ORG2`。通过将组织的`MSP`添加到通道配置来实现组织在通道上的表示。例如，该图的通道由`ORG1`和`ORG2`管理。类似的原则适用于网络，订购者和用户，但为简单起见，此处未显示这些原则。 

通过查看区块链管理员安装和实例化智能合约时会发生什么，您可能会发现如何使用本地`MSP`和通道`MSP`很有帮助，如上[图所示](https://hyperledger-fabric.readthedocs.io/en/latest/membership/membership.html#msp2img)。

管理员`B`使用由`RCA1` 本地`MSP` 发布并存储在其本地`MSP`中的标识连接到对等方。当`B`尝试在对等体上安装智能合约时，对等体检查其本地`MSP` `ORG1-MSP`，以验证其身份`B`确实是其成员`ORG1`。成功验证将允许`install`命令成功完成。随后，`B`希望在通道上实例化智能合约。因为这是一个通道操作，所以通道上的所有组织都必须同意。因此，对等方必须先检查通道的`MSP`，然后才能成功提交此命令。（其他事情也必须发生，但现在集中精力于上述。）

**本地MSP仅在**它们应用**的节点或用户的文件系统上定义**。因此，在物理上和逻辑上，每个节点或用户只有一个本地`MSP`。但是，由于通道`MSP`可用于通道中的所有节点，因此它们在通道配置中进行逻辑定义一次。但是， **通道MSP也在通道中每个节点的文件系统上实例化，并通过一致性保持同步**。因此，虽然每个节点的本地文件系统上存在每个通道`MSP`的副本，但逻辑上`MSP`通道驻留在该通道上并由通道或网络维护。

## MSP级别

通道和本地`MSP`之间的分离反映了组织管理其本地资源（例如对等或订购者节点）及其渠道资源（例如在渠道或网络级别运营的分类帐，智能合约和财团）的需求。将这些`MSP`视为处于不同**层次**是有帮助的，**MSP处于与网络管理问题相关的更高级别，**而**较低级别的MSP处理私有资源管理的身份**。`MSP`在每个管理级别都是必需的，必须为网络，渠道，对等，订购者和用户定义`MSP`。

![MSP3](https://hyperledger-fabric.readthedocs.io/en/latest/_images/membership.diagram.2.png)

`MSP`级别：对等体和订购者的`MSP`是本地的，而通道的`MSP`（包括网络配置通道）在该通道的所有参与者之间共享。在此图中，网络配置通道由`ORG1`管理，但另一个应用程序通道可由`ORG1`和`ORG2`管理。对等体是`ORG2`的成员和管理者，而`ORG1`管理图的订购者。`ORG1`信任来自`RCA1`的身份，而`ORG2`信任来自`RCA2`的身份。请注意，这些是管理身份，反映了谁可以管理这些组件。因此，当`ORG1`管理网络时，`ORG2.MSP`确实存在于网络定义中。

+ **网络MSP**：网络的配置定义了谁是网络中的成员，通过定义参与组织的`MSP` ，以及这些成员中的哪些成员被授权执行管理任务（例如，创建通道）。
+ **通道MSP**：通道必须单独维护其成员的`MSP`。**通道在特定的一组组织之间提供私人通信**，这些组织又对其进行管理控制。在通道的`MSP`环境中解释的通道策略定义谁有能力参与通道上的某些行动，例如，添加组织或实例化链码。请注意，管理通道的权限与管理网络配置通道（或任何其他通道）的权限之间没有必然的关系。管理权限存在于管理范围内（除非规则已经另行规定 - 请参阅`ROLE`下面对属性的讨论）。
+ **对等MSP**：此本地`MSP`在每个对等体的文件系统上定义，并且每个对等体都有一个`MSP`实例。从概念上讲，它执行与通道`MSP`完全相同的功能，其限制是它仅适用于定义它的对等方。使用对等方的本地`MSP`评估其授权的操作的示例是在对等方上安装链代码。
+ **Orderer MSP**：与对等`MSP`一样，**orderer**本地`MSP`也在节点的文件系统上定义，仅适用于该节点。与对等节点一样，`orderers`也由单个组织拥有，因此只有一个`MSP`来列出它信任的参与者或节点。

## MSP结构

到目前为止，已经看到`MSP`最重要的元素是用于在相应组织中建立参与者或节点成员资格的根`CA`或中间`CA`的规范。但是，有更多的元素与这两个元素结合使用以协助成员函数。

![MSP4](https://hyperledger-fabric.readthedocs.io/en/latest/_images/membership.diagram.5.png)

上图显示了本地`MSP`如何存储在本地文件系统中。尽管通道`MSP`的物理结构并非如此，但它仍然是一种有用的思考方式。

`MSP`有九个元素。最简单的方法是在目录结构中考虑这些元素，其中`MSP`名称是根文件夹名称，每个子文件夹代表`MSP`配置的不同元素。

让我们更详细地描述这些文件夹，看看它们的重要性：

+ **根`CA`**：此文件夹包含由此`MSP`表示的组织信任的根`CA`的自签名`X.509`证书列表。此`MSP`文件夹中必须至少有一个`Root CA X.509`证书。

  这是最重要的文件夹，因为它标识了必须从中派生所有其他证书才能被视为相应组织的成员的`CA`。

+ **中间`CA`**：此文件夹包含此组织信任的中间`CA`的`X.509`证书列表。每个证书必须由`MSP`中的一个根`CA`或中间`CA`签名，中间`CA`的颁发`CA`链最终会返回到受信任的根`CA`。

  中间`CA`可以表示组织的不同细分（如`ORG1-MANUFACTURING`和`ORG1-DISTRIBUTION`做`ORG1`），或组织本身（如果商业`CA`用于组织的身份管理，则可能是这种情况）。在后一种情况下，中间`CA`可用于表示组织细分。[在这里，](https://hyperledger-fabric.readthedocs.io/en/latest/msp.html)您可以找到有关`MSP`配置最佳实践的更多信息。请注意，可能有一个没有中间`CA`的正常运行的网络，在这种情况下，此文件夹将为空。

  与根`CA`文件夹一样，此文件夹定义必须颁发证书才能被视为组织成员的`CA`。

+ **组织单位（`OU`）**：这些单位列在`$FABRIC_CFG_PATH/msp/config.yaml` 文件中，包含一个组织单位列表，其成员被视为该`MSP`所代表的组织的一部分。当您希望将组织成员限制为拥有其中包含特定`OU`的身份（由`MSP`指定的`CA`之一签名）的成员时，此功能尤其有用。

  指定`OU`是可选的。如果未列出任何`OU`，则作为`MSP`一部分的所有身份（由根`CA`和中间`CA`文件夹标识）将被视为组织的成员。

+ **管理员**：此文件夹包含一个标识列表，用于定义具有此组织管理员角色的角色。对于标准`MSP`类型，此列表中应该有一个或多个`X.509`证书。

  值得注意的是，仅仅因为一个参与者具有管理员的角色，并不意味着他们可以管理特定的资源！给定标识在管理系统方面的实际功率由管理系统资源的策略决定。例如，通道策略可能指定`ORG1-MANUFACTURING` 管理员有权将新组织添加到渠道，而 `ORG1-DISTRIBUTION`管理员则没有此类权限。

  即使`X.509`证书具有一个`ROLE`属性（例如，指定一个参与者是一个`admin`），这指的是一个参与者在其组织内而不是在区块链网络中的角色。这类似于`OU`属性的目的，如果已定义属性，则指的是参与者在组织中的位置。

  如果已编写该通道的策略以允许组织（或某些组织）的任何管理员执行某些通道功能（例如实例化链代码），则该`ROLE`属性**可**用于在通道级别授予管理权限。通过这种方式，组织角色可以赋予网络角色。

+ **撤销证书**：如果**已撤销参与者**的身份，则在此文件夹中保存有关身份的信息， 而不是身份本身。对于基于`X.509`的标识，这些标识符是称为主题密钥标识符（`SKI`）和授权访问标识符（`AKI`）的字符串对，并且只要使用`X.509`证书来确保证书未被证实，就会对其进行检查。撤销。

  此列表在概念上与`CA`的证书吊销列表（`CRL`）相同，但它也与从组织中撤消成员身份有关。因此，`MSP`（本地或通道）的管理员可以通过向`CA`发布的已撤销证书发布更新的`CRL`来快速撤销组织中的参与者或节点。这个“列表列表”是可选的。它只会在证书被撤销时填充。

+ **节点标识**：此文件夹包含**节点的标识**，即加密材料与内容的组合`KeyStore`，将允许节点在发送给其通道和网络的其他参与者的消息中验证自身。对于基于`X.509`的标识，此文件夹包含**`X.509`证书**。这是对等体在交易提议响应中放置的证书，例如，用于指示对等方已经认可它，随后可以在验证时针对结果交易的认可策略进行检查。

  此文件夹对于本地`MSP`是必需的，并且该节点必须只有一个`X.509`证书。它不用于通道`MSP`。

+ **`KeyStore`对于私钥**：此文件夹是为对等或订购者节点（或客户端的本地`MSP`）的本地`MSP`定义的，并包含节点的**签名密钥**。此密钥以加密方式匹配**节点标识** 文件夹中包含的**节点标识**，并用于签署数据。例如签署交易提议响应，作为认可阶段的一部分。

  此文件夹对于本地`MSP`是必需的，并且必须只包含一个私钥。显然，对此文件夹的访问权限必须仅限于对等人具有管理职责的用户的身份。

  **通道MSP的**配置不包括此文件夹，因为通道`MSP`仅旨在提供身份验证功能而不是签名功能。

+ **`TLS`根`CA`**：此文件夹包含此组织信任的**用于TLS通信**的根`CA`的自签名`X.509`证书列表。`TLS`通信的一个示例是当对等方需要连接到订货人以便它可以接收分类帐更新时。

  `MSP TLS`信息涉及网络内的节点对等体和订购者，换句话说，而不是消耗网络的应用程序和管理。

  此文件夹中必须至少有一个`TLS`根`CA X.509`证书。

+ **`TLS`中间`CA`**：此文件夹包含由该`MSP`所代表的组织信任的名单中间`CA`证书的`CA` **的`TLS`通信**。当商业`CA`用于组织的`TLS`证书时，此文件夹特别有用。与成员资格中间`CA`类似，指定中间`TLS CA`是可选的。

# `Peer` 对等节点

区块链网络主要由**一组对等节点组成**。对等节点是网络的基本要素，因为他们主持**分类账和智能合约**。回想一下，**分类账**可以不可避免地**记录智能合约（或链码）生成的所有交易**。**智能合约和分类帐**分别用于封装网络中的**共享进程和共享信息**。同行的这些方面使他们成为了解`Hyperledger Fabric`网络的良好起点。

区块链网络的其他元素当然很重要：分类帐和智能合约，共识，策略，通道，应用程序，组织，身份和成员资格，可以在自己的专门章节中阅读更多相关信息。本节重点介绍对等体及其与`Hyperledger Fabric`网络中其他元素的关系。

![Peer1](https://hyperledger-fabric.readthedocs.io/en/latest/_images/peers.diagram.1.png)

区块链网络由对等节点组成，每个对等节点可以保存**分类账的副本和智能合约的副本**。在该示例中，网络`N`由对等体`P1`，`P2`和`P3`组成，每个对等体保持它们自己的分布式分类帐`L1`的实例。`P1`，`P2`和`P3`使用相同的链码`S1`来访问其分布式分类帐的副本。

可以创建，启动，停止，重新配置甚至删除对等体。它们公开了一组`API`，使管理员和应用程序能够与他们提供的服务进行交互。我们将在本节中详细了解这些服务。

## 术语解释

`Hyperledger Fabric`采用一种技术概念实现**智能合约**，它称之为**链码**。 只是一段访问分类账的代码，用一种支持的编程语言编写。在本主题中，我们通常使用术语链代码，但如果您更习惯该术语，请随意将其作为智能合约阅读。这是同一件事！

## 分类账本和智能合约

让我们更详细地看一下同行。我们可以看到**它是托管分类帐和链代码**的同行。更准确地说，**对等体实际上托管分类帐的实例和链代码的实例**。请注意，这在`Fabric`网络中提供了有意的冗余，它**避免了单点故障**。我们将在本节后面详细了解区块链网络的分布式和分散性。

![Peer2](https://hyperledger-fabric.readthedocs.io/en/latest/_images/peers.diagram.2.png)

对等体托管分类帐实例和链代码实例。在此示例中，`P1`承载分类帐`L1`的实例和链代码`S1`的实例。可以在单个对等体上托管许**多分类帐和链代码**。

由于**对等方是分类帐和链代码的主机**，因此应用程序和管理员必须与对等方**进行交互**才能访问这些资源。这就是为什么`peer`被认为是`Hyperledger Fabric`网络最基本的构建块。**首次创建对等体时，它既没有分类账，也没有链码**。稍后我们将看到如何在同行上创建分类帐以及如何安装链代码。

### 多个分类账本

对等方能够托管多个分类帐，这很有用，因为它允许**灵活的系统设计**。最简单的配置是让对等方管理单个分类帐，但对于对等方来说，在需要时托管两个或多个分类帐绝对合适。

![Peer3](https://hyperledger-fabric.readthedocs.io/en/latest/_images/peers.diagram.3.png)

托管多个分类帐的对等方。对等方托管一个或多个分类帐，每个分类帐具有零个或多个适用于它们的链代码。在这个例子中，我们可以看到对等体`P1`托管分类账`L1`和`L2`。使用链码`S1`访问分类帐`L1`。另一方面，可以使用链码`S1`和`S2`访问`Ledger L2`。

尽管对等体完全有可能在**没有托管**任何访问该**分类帐**的**链代码**的情况下托管分类帐实例，但很少有对等方以这种方式配置。**绝大多数对等体将至少安装一个链代码，可以查询或更新对等方的分类帐实例**。值得一提的是，无论用户是否安装了外部应用程序使用的链代码，**对等体还具有始终存在的特殊系统链代码**。本主题中未详细讨论这些内容。

### 多个链码

对等方拥有的分类账数量与可以访问该分类账的链代码数量之间没有固定的关系。对等体可能有许多链码和许多分类账。

![Peer4](https://hyperledger-fabric.readthedocs.io/en/latest/_images/peers.diagram.4.png)

上图是：托管多个链代码的对等方的示例。**每个分类帐都可以有许多访问它的链代码**。在这个例子中，我们可以看到对等体`P1`托管分类账`L1`和`L2`，其中`L1`由链代码`S1`和`S2`访问，`L2`由`S1`和`S3`访问。我们可以看到`S1`可以访问`L1`和`L2`。

稍后我们会看到为什么`Hyperledger Fabric`中的**通道**概念在同级托管多个分类帐或多个链代码时很重要。

## 应用程序和对等节点

我们现在将展示应用程序如何与对等方交互以访问分类帐。分类帐查询交互涉及应用程序和对等方之间的简单三步对话。分类帐更新交互涉及更多，需要两个额外的步骤。我们已经简化了这些步骤以帮助您开始使用`Hyperledger Fabric`，但不要担心，最重要的是要理解的是，与分类帐更新交易风格相比，分类帐查询的应用程序 - 对等交互的差异。

应用程序在需要**访问分类帐和链代码时始终连接到对等方**。`Hyperledger Fabric`软件开发工具包（`SDK`）使程序员易于使用，**它的`API`使应用程序能够连接到对等端，调用链式代码以生成交易，将交易提交到将共识节点并提交到分布式分类帐的网络，以及在接收事件时接收事件这个过程完成了**。

通过对等连接，应用程序可以**执行链代码来查询或更新分类帐**。分类帐查询交易的结果立即返回，而分类帐更新涉及应用程序、对等节点和共识节点之间更复杂的交互。让我们更详细地研究一下。

![Peer6](https://hyperledger-fabric.readthedocs.io/en/latest/_images/peers.diagram.6.png)

同行节点与共识节点一起**确保分类账与每个同行保持同步**。在此示例中，应用程序`A`连接到`P1`并调用链代码`S1`来查询或更新分类帐`L1`。`P1`调用`S1`以生成包含查询结果或建议的分类帐更新的提议响应。应用程序`A`接收提议响应，对于查询，该过程现在已完成。对于更新，`A`从所有响应构建一个事务，并将其发送给`O1`进行排序。`O1`将来自网络的事务收集到块中，并将这些事务分发给所有对等体，包括`P1`。`P1`在申请`L1`之前验证交易。更新`L1`后，`P1`会生成`A`收到的事件，表示完成。

**对等体可以立即将查询结果返回给应用程序**，因为满足查询所需的所有信息都在**对等体的分类帐本地副本**中。对等方从不咨询其他对等方以响应来自应用程序的查询。但是，应用程序**可以连接到一个或多个对等方以发出查询**。例如，在**多个对等体之间确认结果**，或者如果**怀疑**信息可能**已过期**，则从另一个对等体检索更新的结果。在图中，您可以看到分类帐查询是一个**简单的三步过程**。

更新事务以与查询事务相同的方式启动，但还有**两个额外步骤**。虽然分类帐更新应用程序也连接到对等方以调用链代码，但与分类帐查询应用程序不同，**单个对等方此时无法执行分类帐更新**，因为其他**对等方必须首先同意此更改，称为共识的过程**。因此，对等方向应用程序返回提议的更新。该对等方将根据**其他对等方先前的协议应用该更新**。第一个额外步骤 —— 第四步：要求应用程序向**整个对等网络发送一组适当的匹配提议更新**，作为对其各自分类帐的**承诺**的交易。这是通过应用程序**使用`orderer`将交易打包到块中，并将它们分发到整个对等网络来实现的**，在应用于每个对等方的本地副本之前，可以对它们进行验证。由于整个排序处理需要一些时间才能完成（秒），因此将**异步通知应用程序**，如步骤5所示。

在本节的后面部分，将了解有关此排序过程的详细性质的更多信息，有关此过程的详细信息，请参阅“ [事务流程”](https://hyperledger-fabric.readthedocs.io/en/latest/txflow.html)主题。

## 对等节点和通道

虽然这一部分是关于同行节点而不是通道，但是值得花些时间了解对等方如何相互交互，以及**通过通道与应用程序进行交互**，**区块链网络中的一组组件可以通过这种机制进行私密交流和交易**。

**这些组件通常是对等节点，共识节点和应用程序，并且通过加入通道，他们同意协作以共同共享和管理与该频道相关联的分类帐的相同副本**。从概念上讲，可以将频道视为与朋友群体相似（尽管频道成员当然不需要成为朋友）。一个人可能有几组朋友，每组都有他们一起做的活动。这些群体可能是完全独立的（与一群爱好朋友相比，一群工作朋友），或者他们之间可能存在一些交叉。然而，每个群体都是自己的实体，具有一种“规则”。

![Peer5](https://hyperledger-fabric.readthedocs.io/en/latest/_images/peers.diagram.5.png)

**通道允许一组特定的对等体和应用程序在区块链网络内相互通信**。在此示例中，应用程序`A`可以使用通道`C`直接与对等方`P1`和`P2`通信。可以将**通道视为**特定应用程序和对等方之间**通信的途径**。（为简单起见，此图中未显示共识服务，但必须存在于正常运行的网络中。）

我们看到通道的存在方式与对等方不同，将通道视为由物理对等体集合形成的逻辑结构更为合适。了解这一点至关重要，**对等节点提供了访问和管理通道的控制点**。

## 对等节点和组织

现在了解了同行节点及其与分类账，链码和通道的关系，将能够看到**多个组织**如何聚集在一起形成区块链网络。

区块链网络由**一组组织**而不是一个组织管理。对等体是如何构建这种分布式网络的核心，因为它们由这些组织所拥有，这些组织并且是网络的连接点。

![Peer8](https://hyperledger-fabric.readthedocs.io/en/latest/_images/peers.diagram.8.png)

与多个组织的区块链网络中的同行，**区块链网络由不同组织拥有和贡献的同行构建**。在此示例中，我们看到有四个组织贡献了八个对等组成网络。信道`C`连接网络`N-P1`，`P3`，`P5`，`P7`和`P8`中的这些对等体中的五个。这些组织拥有的其他同行尚未加入此通道，但通常会加入至少一个其他通道。由特定组织开发的应用程序将连接到自己组织的同行以及不同组织的同行。同样，为简单起见，此图中未显示订购者节点。

## 对等节点和身份



## 对等节点和共识服务

