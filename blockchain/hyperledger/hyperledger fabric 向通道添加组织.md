# `hyperledger fabric` 向通道添加组织

在开始之前，请确保已按照安装**示例，二进制文件和Docker镜像**以及符合本文档版本的二进制文件。特别是，`fabric-samples`文件夹版本必须包含`eyfn.sh`（扩展你的第一个网络）脚本及其相关脚本。

**本教程用作构建你的第一个网络（`BYFN`）教程的扩展**，并将演示向`BYFN`自动生成的应用程序通道（`mychannel`）添加新组织`Org3`。它假设对`BYFN`有很强的理解，包括上述实用程序的用法和功能。

虽然仅关注此处新组织的扩展集成，但在执行其他**通道配置更新**（例如更新修改策略或更改批量大小）时可以采用相同的方法。要了解有关通道配置更新的过程和可能性的更多信息，请查看[更新通道配置](https://hyperledger-fabric.readthedocs.io/en/latest/config_update.html)。同样值得注意的是，像这里演示的频道配置更新通常是**组织管理员**（而不是链码或应用程序开发人员）的责任。

> **注意**：在继续之前，请确保自动`byfn.sh`脚本在计算机上运行时没有错误。如果已将**二进制文件和相关工具（`cryptogen`，`configtxgen`等）导出到`PATH`变量中**，则可以相应地修改命令而不传递完全限定的路径。

# 设置环境

将在本地`Fabric-samples`克隆中的第一个网络子目录的根目录下运行。立即切换到该目录。还需要打开一些额外的终端以方便使用。

```sh
$ cd fabric-samples/first-network
```

首先，**使用`byfn.sh`脚本进行容器或数据、镜像清理工作**。此命令将**终止所有活动或过时的`docker`容器并删除以前生成的配置工件**。为了执行通道配置更新任务，无需关闭`Fabric`网络。但是，为了本教程的目的，希望从已知的初始状态进行操作。因此，让我们运行以下命令来清理以前的所有环境：

```sh
$ ./byfn.sh down
```

现在生成默认的`BYFN`配置工件：

```sh
$ ./byfn.sh generate
```

并使用`CLI`容器中的脚本执行启动网络：

```sh
$ ./byfn.sh up
```

现在机器上运行了一个干净的`BYFN`版本，可以使用两种不同的路径。首先，提供一个完全注释的脚本，它将执行配置事务更新以将`Org3`引入网络。

此外，将显示相同过程的“**手动**”版本，显示每个步骤并解释它完成的内容（因为展示如何在此手动过程之前关闭网络，还可以运行脚本然后查看每个步骤）。

# 用脚本将`Org3`加入到通道

首先使用如下脚本，只需发出以下命令：

```sh
$ ./eyfn.sh up
```

这里的输出非常值得一读。可以看到**添加了`Org3`加密文件，创建并签署了配置更新**，然后安装了链码以允许`Org3`执行分类帐查询。

如果一切顺利，你会得到这样的信息：

```sh
========= All GOOD, EYFN test execution completed ===========
```

通过执行以下命令（而不是`./byfn.sh up`），`eyfn.sh`可以与`byfn.sh`使用相同的`Node.js`链码和数据库选项：

```sh
$ ./byfn.sh up -c testchannel -s couchdb -l node
```

然后：

```sh
$ ./eyfn.sh up -c testchannel -s couchdb -l node
```

对于那些想要仔细研究这个过程的人来说，文档的其余部分将向你展示进行频道更新的每个命令以及它的作用。

